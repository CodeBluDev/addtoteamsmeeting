{"version":3,"file":"commands.js","mappings":"AAOAA,OAAOC,QAAQ,WACb,GAmDFD,OAAOE,QAAQC,UAAU,yBA5CzB,SAAgCC,GAC9B,IAAMC,EAAOL,OAAOM,QAAQC,QAAQF,KAGpCA,EAAKG,KAAKC,SAAST,OAAOU,aAAaC,KAAM,SAACC,GAC5C,GAAIA,EAAWC,SAAWb,OAAOc,kBAAkBC,UAMjD,OALAV,EAAKW,qBAAqBC,aAAa,QAAS,CAC9CC,KAAMlB,OAAOmB,aAAaC,4BAA4BC,aACtDC,QAAS,sCAEXlB,EAAMmB,YAIR,IAIMC,EAJWZ,EAAWa,MAILD,MADJ,8DAGnB,IAAKA,EAMH,OALAnB,EAAKW,qBAAqBC,aAAa,SAAU,CAC/CC,KAAMlB,OAAOmB,aAAaC,4BAA4BM,qBACtDJ,QAAS,+DAEXlB,EAAMmB,YAIR,IAAMI,EAAYH,EAAM,GAClBI,EAAc,4BAAHC,OAA+BF,GAGhDtB,EAAKyB,SAASC,SAASH,EAAa,WAClCvB,EAAKW,qBAAqBC,aAAa,UAAW,CAChDC,KAAMlB,OAAOmB,aAAaC,4BAA4BM,qBACtDJ,QAAS,0CAEXlB,EAAMmB,WACR,EACF,EACF","sources":["webpack://office-addin-taskpane-js/./src/commands/commands.js"],"sourcesContent":["/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global Office */\n\nOffice.onReady(() => {\n  // If needed, Office.js is ready to be called.\n});\n\n/**\n * Shows a notification when the add-in command is executed.\n * @param event {Office.AddinCommands.Event}\n */\nfunction addTeamsLinkToLocation(event) {\n  const item = Office.context.mailbox.item;\n\n  // Read the meeting body as HTML\n  item.body.getAsync(Office.CoercionType.Html, (bodyResult) => {\n    if (bodyResult.status !== Office.AsyncResultStatus.Succeeded) {\n      item.notificationMessages.replaceAsync(\"error\", {\n        type: Office.MailboxEnums.ItemNotificationMessageType.ErrorMessage,\n        message: \"Unable to read meeting body.\"\n      });\n      event.completed();\n      return;\n    }\n\n    const bodyHtml = bodyResult.value;\n\n    // Extract the Teams meeting link\n    const teamsRegex = /https:\\/\\/teams\\.microsoft\\.com\\/l\\/meetup-join\\/[^\\s\"<]+/i;\n    const match = bodyHtml.match(teamsRegex);\n\n    if (!match) {\n      item.notificationMessages.replaceAsync(\"noLink\", {\n        type: Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,\n        message: \"No Microsoft Teams meeting link found in this invite.\"\n      });\n      event.completed();\n      return;\n    }\n\n    const teamsLink = match[0];\n    const newLocation = `Microsoft Teams Meeting\\n${teamsLink}`;\n\n    // Write the Teams link into the Location field\n    item.location.setAsync(newLocation, () => {\n      item.notificationMessages.replaceAsync(\"success\", {\n        type: Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,\n        message: \"Teams meeting link added to Location.\"\n      });\n      event.completed();\n    });\n  });\n}\n\n// Register the function with Office.\nOffice.actions.associate(\"addTeamsLinkToLocation\", addTeamsLinkToLocation);\n"],"names":["Office","onReady","actions","associate","event","item","context","mailbox","body","getAsync","CoercionType","Html","bodyResult","status","AsyncResultStatus","Succeeded","notificationMessages","replaceAsync","type","MailboxEnums","ItemNotificationMessageType","ErrorMessage","message","completed","match","value","InformationalMessage","teamsLink","newLocation","concat","location","setAsync"],"ignoreList":[],"sourceRoot":""}