{"version":3,"file":"authDialog.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/./src/dialogs/auth.js"],"sourcesContent":["/* global Office, msal */\n\nfunction sendMessage(type, payload) {\n  Office.context.ui.messageParent(JSON.stringify({ type, ...payload }));\n}\n\nfunction receiveConfig(message) {\n  try {\n    return JSON.parse(message);\n  } catch (error) {\n    return null;\n  }\n}\n\nOffice.onReady(() => {\n  Office.context.ui.addHandlerAsync(\n    Office.EventType.DialogParentMessageReceived,\n    async (arg) => {\n      const config = receiveConfig(arg.message);\n      if (!config || !config.clientId) {\n        sendMessage(\"error\", { message: \"Missing auth configuration.\" });\n        return;\n      }\n\n      const msalConfig = {\n        auth: {\n          clientId: config.clientId,\n          authority: config.authority || \"https://login.microsoftonline.com/organizations\",\n          redirectUri: window.location.origin + window.location.pathname\n        },\n        cache: {\n          cacheLocation: \"sessionStorage\"\n        }\n      };\n\n      const app = new msal.PublicClientApplication(msalConfig);\n      const scopes = config.scopes || [\"https://graph.microsoft.com/Calendars.ReadWrite\"];\n\n      try {\n        const loginResult = await app.loginPopup({ scopes });\n        const account = loginResult.account;\n        const tokenResult = await app.acquireTokenSilent({\n          scopes,\n          account\n        });\n        sendMessage(\"token\", { accessToken: tokenResult.accessToken });\n      } catch (error) {\n        try {\n          const fallback = await app.acquireTokenPopup({ scopes });\n          sendMessage(\"token\", { accessToken: fallback.accessToken });\n        } catch (popupError) {\n          sendMessage(\"error\", { message: popupError.message || \"Auth failed.\" });\n        }\n      }\n    }\n  );\n});\n"],"names":["e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","ownKeys","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","push","apply","_defineProperty","_typeof","toPrimitive","String","_toPrimitive","_toPropertyKey","sendMessage","type","payload","Office","context","ui","messageParent","JSON","stringify","arguments","forEach","getOwnPropertyDescriptors","defineProperties","_objectSpread","receiveConfig","message","parse","error","onReady","addHandlerAsync","EventType","DialogParentMessageReceived","_ref","_callee","arg","config","msalConfig","app","scopes","loginResult","account","_context","clientId","auth","authority","redirectUri","window","location","origin","pathname","cache","cacheLocation","msal","PublicClientApplication","loginPopup","acquireTokenSilent","accessToken","acquireTokenPopup","_next","_throw","_x"],"ignoreList":[],"sourceRoot":""}