{"version":3,"file":"commands.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/./src/commands/commands.js"],"sourcesContent":["/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global Office, OfficeRuntime */\n\nOffice.onReady(() => {\n  // If needed, Office.js is ready to be called.\n});\n\nconst BUILD_TAG = \"v1.8.4\";\nconst BUILD_MARKER = \"2026-01-01T14:28Z\";\nconst EWS_MESSAGES_NS = \"http://schemas.microsoft.com/exchange/services/2006/messages\";\nconst EWS_TYPES_NS = \"http://schemas.microsoft.com/exchange/services/2006/types\";\nconst DEBUG_LOGS = true;\nconst NOTIFICATION_ICON_ID = \"Icon.16x16\";\nconst DIALOG_URL = \"https://codebludev.github.io/addtoteamsmeeting/create-event.html?v=1.8.4\";\nconst GRAPH_BASE_URL = \"https://graph.microsoft.com/v1.0\";\nconst GRAPH_SEARCH_DAYS = 90;\nconst AAD_CLIENT_ID = \"226fcb0c-fa77-48bb-a20e-70a75ce176fd\";\nconst AAD_AUTHORITY = \"https://login.microsoftonline.com/organizations\";\nconst GRAPH_SCOPES = [\"https://graph.microsoft.com/Calendars.ReadWrite\"];\nconst AUTH_DIALOG_URL = \"https://codebludev.github.io/addtoteamsmeeting/auth.html?v=1.8.4\";\nlet cachedGraphToken = null;\nlet cachedGraphTokenExpiresAt = 0;\n\n/**\n * Shows a notification when the add-in command is executed.\n * @param event {Office.AddinCommands.Event}\n */\nfunction addTeamsLinkToLocation(event) {\n  const item = Office.context.mailbox.item;\n  logDebug(\"Command invoked\", { itemId: item.itemId, itemType: item.itemType });\n\n  // Read the message body as HTML\n  item.body.getAsync(Office.CoercionType.Html, (bodyResult) => {\n    logDebug(\"Body getAsync result\", { status: bodyResult.status });\n    if (bodyResult.status !== Office.AsyncResultStatus.Succeeded) {\n      item.notificationMessages.replaceAsync(\"error\", {\n        type: Office.MailboxEnums.ItemNotificationMessageType.ErrorMessage,\n        message: \"Unable to read message body.\"\n      });\n      event.completed();\n      return;\n    }\n\n    const bodyHtml = bodyResult.value;\n\n    // Extract the Teams meeting link\n    const teamsLink = extractTeamsLink(bodyHtml);\n    logDebug(\"Teams link match\", { found: Boolean(teamsLink) });\n\n    if (!teamsLink) {\n      notifyInfo(item, \"No Microsoft Teams meeting link found in this invite.\");\n      event.completed();\n      return;\n    }\n\n    logDebug(\"Teams link extracted\", { teamsLink });\n    runEwsHealthCheck((ewsOk, ewsMessage) => {\n      if (!ewsOk) {\n        notifyError(item, `EWS health check failed: ${ewsMessage}`);\n        event.completed();\n        return;\n      }\n\n      findCalendarItemByTeamsLink(teamsLink, (findError, calendarItem) => {\n      logDebug(\"Find by link\", { error: Boolean(findError), found: Boolean(calendarItem) });\n      if (findError) {\n        notifyError(item, `EWS error: ${formatEwsError(findError)}`);\n        notifyInfo(item, \"Opening event dialog (calendar search blocked).\");\n        openCreateEventDialog(item, teamsLink);\n        event.completed();\n        return;\n      }\n\n      if (calendarItem) {\n        updateCalendarItemLocation(calendarItem, teamsLink, (updateError) => {\n          if (updateError) {\n            notifyError(item, \"Unable to update the calendar location.\");\n          } else {\n            notifySuccess(item);\n          }\n          event.completed();\n        });\n        return;\n      }\n\n      getMessageTimeRange(item, (timeError, timeRange) => {\n        logDebug(\"Message time range\", { error: Boolean(timeError), hasRange: Boolean(timeRange) });\n        if (timeError || !timeRange) {\n          notifyInfo(item, \"No matching calendar event found.\");\n          event.completed();\n          return;\n        }\n\n        findCalendarItemByTimeRange(timeRange, (timeFindError, timeCalendarItem) => {\n          logDebug(\"Find by time\", {\n            error: Boolean(timeFindError),\n            found: Boolean(timeCalendarItem)\n          });\n          if (timeFindError) {\n            notifyError(item, `EWS error: ${formatEwsError(timeFindError)}`);\n            notifyInfo(item, \"Opening event dialog (calendar search blocked).\");\n            openCreateEventDialog(item, teamsLink);\n            event.completed();\n            return;\n          }\n\n          if (!timeCalendarItem) {\n            notifyInfo(item, \"No matching calendar event found. Opening event dialog.\");\n            openCreateEventDialog(item, teamsLink);\n            event.completed();\n            return;\n          }\n\n          updateCalendarItemLocation(timeCalendarItem, teamsLink, (updateError) => {\n            if (updateError) {\n              notifyError(item, \"Unable to update the calendar location.\");\n            } else {\n              notifySuccess(item);\n            }\n            event.completed();\n          });\n        });\n      });\n      });\n    });\n  });\n}\n\nfunction notifySuccess(item) {\n  item.notificationMessages.replaceAsync(\"success\", {\n    type: Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,\n    icon: NOTIFICATION_ICON_ID,\n    persistent: false,\n    message: `Teams meeting link added to Location. (${BUILD_TAG} | ${BUILD_MARKER})`\n  });\n}\n\nfunction notifyError(item, message) {\n  item.notificationMessages.replaceAsync(\"error\", {\n    type: Office.MailboxEnums.ItemNotificationMessageType.ErrorMessage,\n    message\n  });\n}\n\nfunction notifyInfo(item, message) {\n  item.notificationMessages.replaceAsync(\"info\", {\n    type: Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,\n    icon: NOTIFICATION_ICON_ID,\n    persistent: false,\n    message\n  });\n}\n\nfunction getUtcWindowStart() {\n  const now = new Date();\n  now.setDate(now.getDate() - 7);\n  return now.toISOString();\n}\n\nfunction getUtcWindowEnd() {\n  const now = new Date();\n  now.setDate(now.getDate() + 90);\n  return now.toISOString();\n}\n\nfunction openCreateEventDialog(item, teamsLink) {\n  const baseSubject = item.subject || \"Teams meeting\";\n  const subject = prependBuildTag(baseSubject);\n\n  Office.context.ui.displayDialogAsync(\n    DIALOG_URL,\n    { height: 55, width: 35, displayInIframe: true },\n    (result) => {\n      if (result.status !== Office.AsyncResultStatus.Succeeded) {\n        notifyError(item, \"Unable to open the event dialog.\");\n        return;\n      }\n\n      const dialog = result.value;\n      dialog.addEventHandler(Office.EventType.DialogMessageReceived, (arg) => {\n        let data;\n        try {\n          data = JSON.parse(arg.message);\n        } catch (parseError) {\n          notifyError(item, \"Invalid response from dialog.\");\n          dialog.close();\n          return;\n        }\n\n        if (data.action === \"cancel\") {\n          dialog.close();\n          return;\n        }\n\n        if (data.action !== \"create\") {\n          notifyError(item, \"Unknown dialog response.\");\n          dialog.close();\n          return;\n        }\n\n        const start = new Date(data.start);\n        const end = new Date(data.end);\n        if (Number.isNaN(start.valueOf()) || Number.isNaN(end.valueOf())) {\n          notifyError(item, \"Invalid date/time from dialog.\");\n          dialog.close();\n          return;\n        }\n\n        const subjectWithTag = prependBuildTag(data.subject || baseSubject);\n        Office.context.mailbox.displayNewAppointmentForm({\n          subject: subjectWithTag,\n          location: teamsLink,\n          start,\n          end\n        });\n\n        dialog.close();\n        notifySuccess(item);\n      });\n\n      dialog.addEventHandler(Office.EventType.DialogEventReceived, () => {\n        notifyInfo(item, \"Event dialog closed.\");\n      });\n\n      dialog.messageChild(\n        JSON.stringify({\n          subject,\n          teamsLink\n        })\n      );\n    }\n  );\n}\n\nfunction prependBuildTag(subject) {\n  const prefix = `[${BUILD_TAG}] `;\n  if (!subject) {\n    return prefix.trim();\n  }\n  if (subject.startsWith(prefix)) {\n    return subject;\n  }\n  return `${prefix}${subject}`;\n}\n\nfunction getMessageTimeRange(item, callback) {\n  if (!item.start || !item.end || !item.start.getAsync || !item.end.getAsync) {\n    callback(null, null);\n    return;\n  }\n\n  item.start.getAsync((startResult) => {\n    if (startResult.status !== Office.AsyncResultStatus.Succeeded) {\n      callback(startResult.error, null);\n      return;\n    }\n\n    item.end.getAsync((endResult) => {\n      if (endResult.status !== Office.AsyncResultStatus.Succeeded) {\n        callback(endResult.error, null);\n        return;\n      }\n\n      const start = new Date(startResult.value);\n      const end = new Date(endResult.value);\n      if (Number.isNaN(start.valueOf()) || Number.isNaN(end.valueOf())) {\n        callback(null, null);\n        return;\n      }\n\n      callback(null, { start, end });\n    });\n  });\n}\n\nfunction findCalendarItemByTeamsLink(teamsLink, callback) {\n  const escapedLink = escapeXml(teamsLink);\n  logDebug(\"EWS FindItem by link request prepared\");\n  const request = `<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"\n               xmlns:t=\"${EWS_TYPES_NS}\"\n               xmlns:m=\"${EWS_MESSAGES_NS}\">\n  <soap:Header>\n    <t:RequestServerVersion Version=\"Exchange2013\" />\n  </soap:Header>\n  <soap:Body>\n    <m:FindItem Traversal=\"Shallow\">\n      <m:ItemShape>\n        <t:BaseShape>IdOnly</t:BaseShape>\n      </m:ItemShape>\n      <m:CalendarView StartDate=\"${getUtcWindowStart()}\" EndDate=\"${getUtcWindowEnd()}\" />\n      <m:Restriction>\n        <t:Contains ContainmentMode=\"Substring\" ContainmentComparison=\"IgnoreCase\">\n          <t:FieldURI FieldURI=\"item:Body\" />\n          <t:Constant Value=\"${escapedLink}\" />\n        </t:Contains>\n      </m:Restriction>\n      <m:ParentFolderIds>\n        <t:DistinguishedFolderId Id=\"calendar\" />\n      </m:ParentFolderIds>\n    </m:FindItem>\n  </soap:Body>\n</soap:Envelope>`;\n\n  Office.context.mailbox.makeEwsRequestAsync(request, (result) => {\n    logDebug(\"EWS FindItem by link response\", {\n      status: result.status,\n      error: result.error ? { name: result.error.name, message: result.error.message } : null\n    });\n    if (result.status !== Office.AsyncResultStatus.Succeeded) {\n      callback(result.error, null);\n      return;\n    }\n\n    const calendarItem = parseFirstCalendarItem(result.value);\n    callback(null, calendarItem);\n  });\n}\n\nfunction runEwsHealthCheck(callback) {\n  const request = `<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"\n               xmlns:t=\"${EWS_TYPES_NS}\"\n               xmlns:m=\"${EWS_MESSAGES_NS}\">\n  <soap:Header>\n    <t:RequestServerVersion Version=\"Exchange2013\" />\n  </soap:Header>\n  <soap:Body>\n    <m:GetFolder>\n      <m:FolderShape>\n        <t:BaseShape>IdOnly</t:BaseShape>\n      </m:FolderShape>\n      <m:FolderIds>\n        <t:DistinguishedFolderId Id=\"calendar\" />\n      </m:FolderIds>\n    </m:GetFolder>\n  </soap:Body>\n</soap:Envelope>`;\n\n  Office.context.mailbox.makeEwsRequestAsync(request, (result) => {\n    logDebug(\"EWS health check response\", {\n      status: result.status,\n      error: result.error ? { name: result.error.name, message: result.error.message } : null\n    });\n\n    if (result.status !== Office.AsyncResultStatus.Succeeded) {\n      callback(false, formatEwsError(result.error));\n      return;\n    }\n\n    const xmlDoc = parseXml(result.value);\n    if (!xmlDoc || !isEwsResponseSuccess(xmlDoc)) {\n      callback(false, \"EWS GetFolder failed.\");\n      return;\n    }\n\n    callback(true, \"OK\");\n  });\n}\n\nfunction findCalendarItemByTimeRange(timeRange, callback) {\n  const startIso = timeRange.start.toISOString();\n  const endIso = timeRange.end.toISOString();\n  logDebug(\"EWS FindItem by time request prepared\", { startIso, endIso });\n  const request = `<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"\n               xmlns:t=\"${EWS_TYPES_NS}\"\n               xmlns:m=\"${EWS_MESSAGES_NS}\">\n  <soap:Header>\n    <t:RequestServerVersion Version=\"Exchange2013\" />\n  </soap:Header>\n  <soap:Body>\n    <m:FindItem Traversal=\"Shallow\">\n      <m:ItemShape>\n        <t:BaseShape>IdOnly</t:BaseShape>\n        <t:AdditionalProperties>\n          <t:FieldURI FieldURI=\"calendar:Start\" />\n          <t:FieldURI FieldURI=\"calendar:End\" />\n        </t:AdditionalProperties>\n      </m:ItemShape>\n      <m:CalendarView StartDate=\"${startIso}\" EndDate=\"${endIso}\" />\n      <m:ParentFolderIds>\n        <t:DistinguishedFolderId Id=\"calendar\" />\n      </m:ParentFolderIds>\n    </m:FindItem>\n  </soap:Body>\n</soap:Envelope>`;\n\n  Office.context.mailbox.makeEwsRequestAsync(request, (result) => {\n    logDebug(\"EWS FindItem by time response\", {\n      status: result.status,\n      error: result.error ? { name: result.error.name, message: result.error.message } : null\n    });\n    if (result.status !== Office.AsyncResultStatus.Succeeded) {\n      callback(result.error, null);\n      return;\n    }\n\n    const calendarItem = parseCalendarItemByTime(result.value, timeRange);\n    callback(null, calendarItem);\n  });\n}\n\nfunction updateCalendarItemLocation(calendarItem, location, callback) {\n  const escapedLocation = escapeXml(location);\n  logDebug(\"EWS UpdateItem request prepared\", { itemId: calendarItem.id });\n  const request = `<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"\n               xmlns:t=\"${EWS_TYPES_NS}\"\n               xmlns:m=\"${EWS_MESSAGES_NS}\">\n  <soap:Header>\n    <t:RequestServerVersion Version=\"Exchange2013\" />\n  </soap:Header>\n  <soap:Body>\n    <m:UpdateItem ConflictResolution=\"AlwaysOverwrite\" SendMeetingInvitationsOrCancellations=\"SendToNone\">\n      <m:ItemChanges>\n        <t:ItemChange>\n          <t:ItemId Id=\"${calendarItem.id}\" ChangeKey=\"${calendarItem.changeKey}\" />\n          <t:Updates>\n            <t:SetItemField>\n              <t:FieldURI FieldURI=\"calendar:Location\" />\n              <t:CalendarItem>\n                <t:Location>${escapedLocation}</t:Location>\n              </t:CalendarItem>\n            </t:SetItemField>\n          </t:Updates>\n        </t:ItemChange>\n      </m:ItemChanges>\n    </m:UpdateItem>\n  </soap:Body>\n</soap:Envelope>`;\n\n  Office.context.mailbox.makeEwsRequestAsync(request, (result) => {\n    logDebug(\"EWS UpdateItem response\", {\n      status: result.status,\n      error: result.error ? { name: result.error.name, message: result.error.message } : null\n    });\n    if (result.status !== Office.AsyncResultStatus.Succeeded) {\n      callback(result.error);\n      return;\n    }\n\n    const xmlDoc = parseXml(result.value);\n    if (!xmlDoc || !isEwsResponseSuccess(xmlDoc)) {\n      callback(new Error(\"EWS UpdateItem failed.\"));\n      return;\n    }\n\n    callback(null);\n  });\n}\n\nfunction parseFirstCalendarItem(responseText) {\n  const xmlDoc = parseXml(responseText);\n  if (!xmlDoc) {\n    return null;\n  }\n\n  const itemId = xmlDoc.getElementsByTagNameNS(EWS_TYPES_NS, \"ItemId\")[0];\n  if (!itemId) {\n    return null;\n  }\n\n  return {\n    id: itemId.getAttribute(\"Id\"),\n    changeKey: itemId.getAttribute(\"ChangeKey\")\n  };\n}\n\nfunction parseCalendarItemByTime(responseText, timeRange) {\n  const xmlDoc = parseXml(responseText);\n  if (!xmlDoc) {\n    return null;\n  }\n\n  const calendarItems = xmlDoc.getElementsByTagNameNS(EWS_TYPES_NS, \"CalendarItem\");\n  for (let i = 0; i < calendarItems.length; i += 1) {\n    const calendarItem = calendarItems[i];\n    const startNode = calendarItem.getElementsByTagNameNS(EWS_TYPES_NS, \"Start\")[0];\n    const endNode = calendarItem.getElementsByTagNameNS(EWS_TYPES_NS, \"End\")[0];\n    const itemId = calendarItem.getElementsByTagNameNS(EWS_TYPES_NS, \"ItemId\")[0];\n\n    if (!startNode || !endNode || !itemId) {\n      continue;\n    }\n\n    const start = new Date(startNode.textContent);\n    const end = new Date(endNode.textContent);\n    if (Number.isNaN(start.valueOf()) || Number.isNaN(end.valueOf())) {\n      continue;\n    }\n\n    if (isSameTimeRange(start, end, timeRange)) {\n      return {\n        id: itemId.getAttribute(\"Id\"),\n        changeKey: itemId.getAttribute(\"ChangeKey\")\n      };\n    }\n  }\n\n  return null;\n}\n\nfunction isSameTimeRange(start, end, timeRange) {\n  const toleranceMs = 60000;\n  return (\n    Math.abs(start - timeRange.start) <= toleranceMs &&\n    Math.abs(end - timeRange.end) <= toleranceMs\n  );\n}\n\nfunction parseXml(xmlString) {\n  if (!xmlString) {\n    return null;\n  }\n\n  return new DOMParser().parseFromString(xmlString, \"text/xml\");\n}\n\nfunction isEwsResponseSuccess(xmlDoc) {\n  const responseCode = xmlDoc.getElementsByTagNameNS(EWS_MESSAGES_NS, \"ResponseCode\")[0];\n  return responseCode && responseCode.textContent === \"NoError\";\n}\n\nfunction escapeXml(value) {\n  return String(value)\n    .replace(/&/g, \"&amp;\")\n    .replace(/</g, \"&lt;\")\n    .replace(/>/g, \"&gt;\")\n    .replace(/\"/g, \"&quot;\")\n    .replace(/'/g, \"&apos;\");\n}\n\nfunction extractMeetingId(bodyHtml, teamsLink) {\n  if (teamsLink) {\n    const linkMatch = teamsLink.match(/19:meeting_[^/?\"'\\\\s<>]+/i);\n    if (linkMatch) {\n      return linkMatch[0];\n    }\n  }\n\n  const combined = `${bodyHtml} ${teamsLink || \"\"}`;\n  const decoded = decodeHtmlEntities(decodeLink(combined));\n  const match = decoded.match(/19:meeting_[^/?\"'\\\\s<>]+/i);\n  if (match) {\n    return match[0];\n  }\n\n  const encodedMatch = combined.match(/19%3Ameeting_[^\"'\\\\s<>%]+/i);\n  if (encodedMatch) {\n    return decodeLink(encodedMatch[0]);\n  }\n\n  return null;\n}\n\nasync function findCalendarEventByGraph(teamsLink, meetingId) {\n  const token = await getGraphAccessToken();\n  const start = new Date();\n  const end = new Date(start.getTime() + GRAPH_SEARCH_DAYS * 24 * 60 * 60 * 1000);\n  let url = `${GRAPH_BASE_URL}/me/calendarView?startDateTime=${encodeURIComponent(\n    start.toISOString()\n  )}&endDateTime=${encodeURIComponent(end.toISOString())}` +\n    \"&$select=id,subject,body,location,onlineMeetingUrl,start,end\";\n\n  while (url) {\n    logDebug(\"Graph calendarView request\", {\n      method: \"GET\",\n      url,\n      headers: {\n        Authorization: exposeAuthHeader(token),\n        Prefer: 'outlook.body-content-type=\"text\"'\n      }\n    });\n    const response = await fetch(url, {\n      headers: {\n        Authorization: `Bearer ${token}`,\n        Prefer: 'outlook.body-content-type=\"text\"'\n      }\n    });\n\n    await logGraphResponse(\"calendarView\", response);\n    if (!response.ok) {\n      const text = await response.text();\n      throw new Error(`Graph calendarView failed: ${response.status} ${text}`);\n    }\n\n    const data = await response.json();\n    const items = data.value || [];\n\n    for (let i = 0; i < items.length; i += 1) {\n      if (eventMatchesTeams(items[i], teamsLink, meetingId)) {\n        return items[i].id;\n      }\n    }\n\n    url = data[\"@odata.nextLink\"] || null;\n  }\n\n  return null;\n}\n\nasync function updateCalendarEventLocationGraph(eventId, teamsLink) {\n  const token = await getGraphAccessToken();\n  const body = {\n    location: {\n      displayName: teamsLink\n    }\n  };\n  logDebug(\"Graph update request\", {\n    method: \"PATCH\",\n    url: `${GRAPH_BASE_URL}/me/events/${eventId}`,\n    headers: {\n      Authorization: exposeAuthHeader(token),\n      \"Content-Type\": \"application/json\"\n    },\n    body\n  });\n  const response = await fetch(`${GRAPH_BASE_URL}/me/events/${eventId}`, {\n    method: \"PATCH\",\n    headers: {\n      Authorization: `Bearer ${token}`,\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(body)\n  });\n\n  await logGraphResponse(\"updateEvent\", response);\n  if (!response.ok) {\n    const text = await response.text();\n    throw new Error(`Graph update failed: ${response.status} ${text}`);\n  }\n}\n\nasync function getGraphAccessToken() {\n  if (cachedGraphToken && Date.now() < cachedGraphTokenExpiresAt) {\n    return cachedGraphToken;\n  }\n\n  if (OfficeRuntime && OfficeRuntime.auth && OfficeRuntime.auth.getAccessToken) {\n    try {\n      const token = await OfficeRuntime.auth.getAccessToken({\n        allowSignInPrompt: true,\n        allowConsentPrompt: true,\n        forMSGraphAccess: true\n      });\n      logDebug(\"Graph token acquired (OfficeRuntime)\");\n      cacheGraphToken(token, 50);\n      return token;\n    } catch (error) {\n      logDebug(\"OfficeRuntime auth failed\", { message: error.message });\n    }\n  }\n\n  const token = await getGraphAccessTokenViaDialog();\n  logDebug(\"Graph token acquired (dialog)\");\n  cacheGraphToken(token, 45);\n  return token;\n}\n\nfunction eventMatchesTeams(event, teamsLink, meetingId) {\n  const bodyText = event.body && event.body.content ? event.body.content : \"\";\n  const onlineUrl = event.onlineMeetingUrl || \"\";\n\n  if (meetingId) {\n    if (bodyText.includes(meetingId) || onlineUrl.includes(meetingId)) {\n      return true;\n    }\n  }\n\n  if (teamsLink) {\n    if (bodyText.includes(teamsLink) || onlineUrl.includes(teamsLink)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction cacheGraphToken(token, minutes) {\n  cachedGraphToken = token;\n  cachedGraphTokenExpiresAt = Date.now() + minutes * 60 * 1000;\n}\n\nfunction getGraphAccessTokenViaDialog() {\n  return new Promise((resolve, reject) => {\n    Office.context.ui.displayDialogAsync(\n      AUTH_DIALOG_URL,\n      { height: 60, width: 40, displayInIframe: true },\n      (result) => {\n        if (result.status !== Office.AsyncResultStatus.Succeeded) {\n          const message = result.error && result.error.message ? result.error.message : \"Unknown dialog error.\";\n          logDebug(\"Auth dialog open failed\", { code: result.error && result.error.code, message });\n          reject(new Error(`Unable to open auth dialog: ${message}`));\n          return;\n        }\n\n        const dialog = result.value;\n        dialog.addEventHandler(Office.EventType.DialogMessageReceived, (arg) => {\n          let data;\n          try {\n            data = JSON.parse(arg.message);\n          } catch (parseError) {\n            dialog.close();\n            reject(new Error(\"Invalid auth dialog response.\"));\n            return;\n          }\n\n          if (data.type === \"ready\") {\n            dialog.messageChild(\n              JSON.stringify({\n                clientId: AAD_CLIENT_ID,\n                authority: AAD_AUTHORITY,\n                scopes: GRAPH_SCOPES\n              })\n            );\n            return;\n          }\n\n          if (data.type === \"token\" && data.accessToken) {\n            dialog.close();\n            resolve(data.accessToken);\n            return;\n          }\n\n          dialog.close();\n          reject(new Error(data.message || \"Auth failed.\"));\n        });\n\n        dialog.addEventHandler(Office.EventType.DialogEventReceived, () => {\n          reject(new Error(\"Auth dialog closed.\"));\n        });\n      }\n    );\n  });\n}\n\nfunction extractTeamsLink(bodyHtml) {\n  const teamsRegex = /https:\\/\\/teams\\.microsoft\\.com\\/l\\/meetup-join\\/[^\\s\"<]+/i;\n  const safeLinksRegex = /https:\\/\\/[^\\/]+\\.safelinks\\.protection\\.outlook\\.com\\/[^\\s\"<]+/i;\n  const akaTeamsRegex = /https:\\/\\/aka\\.ms\\/[^\\s\"<]*teams[^\\s\"<]*/i;\n  const directLink = findTeamsLinkInText(bodyHtml);\n  if (directLink) {\n    return directLink;\n  }\n\n  const urls = bodyHtml.match(/https?:\\/\\/[^\\s\"'<>]+/gi) || [];\n  for (let i = 0; i < urls.length; i += 1) {\n    const rawUrl = urls[i];\n    const cleanedUrl = rawUrl.replace(/&amp;/g, \"&\");\n\n    if (teamsRegex.test(cleanedUrl)) {\n      return decodeLink(cleanedUrl);\n    }\n\n    if (safeLinksRegex.test(cleanedUrl)) {\n      const extracted = extractSafeLinkTarget(cleanedUrl);\n      if (extracted) {\n        const decoded = decodeLink(extracted);\n        if (teamsRegex.test(decoded)) {\n          return decoded;\n        }\n      }\n    }\n\n    if (akaTeamsRegex.test(cleanedUrl)) {\n      return cleanedUrl;\n    }\n  }\n\n  return null;\n}\n\nfunction findTeamsLinkInText(text) {\n  const candidates = [];\n  const rawMatches = text.match(/https:\\/\\/teams\\.microsoft\\.com\\/l\\/meetup-join\\/[^\\s\"'<>]+/gi);\n  if (rawMatches) {\n    candidates.push(...rawMatches);\n  }\n\n  const decodedHtml = decodeHtmlEntities(text);\n  const decodedMatches = decodedHtml.match(/https:\\/\\/teams\\.microsoft\\.com\\/l\\/meetup-join\\/[^\\s\"'<>]+/gi);\n  if (decodedMatches) {\n    candidates.push(...decodedMatches);\n  }\n\n  for (let i = 0; i < candidates.length; i += 1) {\n    const cleaned = decodeLink(candidates[i]);\n    if (cleaned) {\n      return cleaned;\n    }\n  }\n\n  return null;\n}\n\nfunction decodeLink(url) {\n  const cleaned = url.replace(/&amp;/g, \"&\");\n  if (/%[0-9A-Fa-f]{2}/.test(cleaned)) {\n    try {\n      return decodeURIComponent(cleaned);\n    } catch (error) {\n      return cleaned;\n    }\n  }\n  return cleaned;\n}\n\nfunction decodeHtmlEntities(text) {\n  return text\n    .replace(/&amp;/g, \"&\")\n    .replace(/&lt;/g, \"<\")\n    .replace(/&gt;/g, \">\")\n    .replace(/&quot;/g, \"\\\"\")\n    .replace(/&#39;/g, \"'\");\n}\n\nfunction extractSafeLinkTarget(safeLinkUrl) {\n  try {\n    const url = new URL(safeLinkUrl);\n    const target = url.searchParams.get(\"url\");\n    if (!target) {\n      return null;\n    }\n    return decodeURIComponent(target);\n  } catch (error) {\n    return null;\n  }\n}\n\nfunction formatEwsError(error) {\n  if (!error) {\n    return \"Unknown error\";\n  }\n\n  const name = error.name || \"EWS error\";\n  const message = error.message || \"No message\";\n  return `${name}: ${message}`;\n}\n\nfunction logDebug(message, data) {\n  if (!DEBUG_LOGS) {\n    return;\n  }\n\n  if (data) {\n    // eslint-disable-next-line no-console\n    console.log(`[AddTeamsLink] ${message}`, data);\n  } else {\n    // eslint-disable-next-line no-console\n    console.log(`[AddTeamsLink] ${message}`);\n  }\n}\n\nasync function logGraphResponse(label, response) {\n  try {\n    const text = await response.clone().text();\n    logDebug(\"Graph response\", {\n      label,\n      status: response.status,\n      ok: response.ok,\n      url: response.url,\n      text\n    });\n  } catch (error) {\n    logDebug(\"Graph response read failed\", { label, message: error.message });\n  }\n}\n\nfunction exposeAuthHeader(token) {\n  if (!token) {\n    return \"Bearer [missing]\";\n  }\n  return `Bearer ${token}`;\n}\n\n// Register the function with Office.\nOffice.actions.associate(\"addTeamsLinkToLocation\", addTeamsLinkToLocation);\n"],"names":["e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_regeneratorDefine","_invoke","enumerable","configurable","writable","_toConsumableArray","_arrayWithoutHoles","_iterableToArray","_unsupportedIterableToArray","_nonIterableSpread","_arrayLikeToArray","toString","slice","constructor","name","Array","from","test","isArray","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","Office","onReady","BUILD_TAG","BUILD_MARKER","EWS_MESSAGES_NS","EWS_TYPES_NS","DEBUG_LOGS","NOTIFICATION_ICON_ID","DIALOG_URL","GRAPH_BASE_URL","GRAPH_SEARCH_DAYS","AAD_CLIENT_ID","AAD_AUTHORITY","GRAPH_SCOPES","AUTH_DIALOG_URL","cachedGraphToken","cachedGraphTokenExpiresAt","addTeamsLinkToLocation","event","item","context","mailbox","logDebug","itemId","itemType","body","getAsync","CoercionType","Html","bodyResult","status","AsyncResultStatus","Succeeded","notificationMessages","replaceAsync","type","MailboxEnums","ItemNotificationMessageType","ErrorMessage","message","completed","bodyHtml","teamsLink","extractTeamsLink","found","Boolean","notifyInfo","runEwsHealthCheck","ewsOk","ewsMessage","notifyError","concat","findCalendarItemByTeamsLink","findError","calendarItem","error","formatEwsError","openCreateEventDialog","updateCalendarItemLocation","updateError","notifySuccess","getMessageTimeRange","timeError","timeRange","hasRange","findCalendarItemByTimeRange","timeFindError","timeCalendarItem","InformationalMessage","icon","persistent","getUtcWindowStart","now","Date","setDate","getDate","toISOString","getUtcWindowEnd","baseSubject","subject","prependBuildTag","ui","displayDialogAsync","height","width","displayInIframe","result","dialog","addEventHandler","EventType","DialogMessageReceived","arg","data","JSON","parse","parseError","close","action","start","end","Number","isNaN","valueOf","subjectWithTag","displayNewAppointmentForm","location","DialogEventReceived","messageChild","stringify","prefix","trim","startsWith","callback","startResult","endResult","escapedLink","escapeXml","request","makeEwsRequestAsync","parseFirstCalendarItem","xmlDoc","parseXml","isEwsResponseSuccess","startIso","endIso","parseCalendarItemByTime","escapedLocation","id","changeKey","Error","responseText","getElementsByTagNameNS","getAttribute","calendarItems","startNode","endNode","textContent","isSameTimeRange","toleranceMs","Math","abs","xmlString","DOMParser","parseFromString","responseCode","String","replace","extractMeetingId","linkMatch","match","combined","decoded","decodeHtmlEntities","decodeLink","encodedMatch","findCalendarEventByGraph","_x","_x2","_findCalendarEventByGraph","_callee","meetingId","token","url","response","text","items","_context","getGraphAccessToken","getTime","encodeURIComponent","method","headers","Authorization","exposeAuthHeader","Prefer","fetch","logGraphResponse","ok","json","eventMatchesTeams","updateCalendarEventLocationGraph","_x3","_x4","_updateCalendarEventLocationGraph","_callee2","eventId","_context2","_getGraphAccessToken","_callee3","_token","_t","_context3","OfficeRuntime","auth","getAccessToken","allowSignInPrompt","allowConsentPrompt","forMSGraphAccess","cacheGraphToken","getGraphAccessTokenViaDialog","bodyText","content","onlineUrl","onlineMeetingUrl","includes","minutes","reject","code","clientId","authority","scopes","accessToken","teamsRegex","safeLinksRegex","akaTeamsRegex","directLink","findTeamsLinkInText","urls","rawUrl","cleanedUrl","extracted","extractSafeLinkTarget","candidates","rawMatches","push","decodedHtml","decodedMatches","cleaned","decodeURIComponent","safeLinkUrl","URL","target","searchParams","get","console","log","_x5","_x6","_logGraphResponse","_callee4","label","_t2","_context4","clone","actions","associate"],"ignoreList":[],"sourceRoot":""}